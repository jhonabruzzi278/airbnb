---
import { getCollection } from "astro:content";

// Obtener datos para stats
const rentals = await getCollection("rentals");
let cars = [];
let experiences = [];
try {
  cars = await getCollection("cars");
} catch (error) {
  console.log("Cars collection not found");
}
try {
  experiences = await getCollection("experiences");
} catch (error) {
  console.log("Experiences collection not found");
}
---

<section class="relative min-h-screen flex items-center overflow-hidden">
  <!-- Background Image - Nueva imagen con protagonismo -->
  <div class="absolute inset-0">
    <picture>
      <source media="(max-width: 768px)" srcset="/home-bg.jpg" />
      <img
        src="/home-bg.jpg"
        alt="Beautiful vacation rental destination"
        class="w-full h-full object-cover"
        loading="eager"
        fetchpriority="high"
      />
    </picture>
    <!-- Overlay m√≠nimo para legibilidad -->
    <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent"></div>
  </div>

  <!-- Hero Content - Efecto cristal -->
  <div class="relative z-10 w-full px-4 text-center text-white">
    <div class="max-w-4xl mx-auto">
      
      <!-- T√≠tulo Principal -->
      <div class="mb-8 md:mb-12">
        <h1 class="text-3xl md:text-5xl lg:text-6xl font-bold mb-4 leading-tight drop-shadow-2xl">
          Your Perfect
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-pink-400 via-purple-400 to-blue-400">
            Adventure Awaits
          </span>
        </h1>
        <p class="text-lg md:text-xl text-white/90 max-w-2xl mx-auto leading-relaxed drop-shadow-lg">
          Discover amazing stays, premium rides, and unforgettable experiences
        </p>
      </div>

      <!-- Botones de Acci√≥n Principales - Efecto Cristal -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center mb-12 md:mb-16">
        <!-- Listing Button -->
        <a
          href="/listing"
          class="scroll-link group bg-white/15 backdrop-blur-lg border border-white/30 hover:bg-white/25 hover:border-white/50 text-white px-8 py-4 rounded-2xl font-semibold text-lg transition-all duration-300 transform hover:scale-105 shadow-2xl"
        >
          <span class="flex items-center justify-center gap-2">
            üè† Find Your Stay
            <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </span>
        </a>
        
        <!-- Cars Button -->
        <a
          href="/cars"
          class="scroll-link group bg-white/15 backdrop-blur-lg border border-white/30 hover:bg-white/25 hover:border-white/50 text-white px-8 py-4 rounded-2xl font-semibold text-lg transition-all duration-300 transform hover:scale-105 shadow-2xl"
        >
          <span class="flex items-center justify-center gap-2">
            üöó Rent a Car
            <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </span>
        </a>

        <!-- Experiences Button -->
        <a
          href="/experience"
          class="scroll-link group bg-white/15 backdrop-blur-lg border border-white/30 hover:bg-white/25 hover:border-white/50 text-white px-8 py-4 rounded-2xl font-semibold text-lg transition-all duration-300 transform hover:scale-105 shadow-2xl"
        >
          <span class="flex items-center justify-center gap-2">
            ‚ú® Experience
            <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </span>
        </a>
      </div>

      <!-- Categor√≠as R√°pidas - Efecto Cristal -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-2xl mx-auto mb-12">
        <a
          href="#featured-properties"
          class="scroll-link group bg-white/10 backdrop-blur-md hover:bg-white/20 border border-white/20 hover:border-white/40 rounded-2xl p-4 transition-all duration-300 transform hover:scale-105 shadow-xl"
        >
          <div class="text-2xl mb-2 group-hover:scale-110 transition-transform duration-300">üèñÔ∏è</div>
          <div class="text-sm font-medium text-white">Beach</div>
        </a>
        <a
          href="#featured-properties"
          class="scroll-link group bg-white/10 backdrop-blur-md hover:bg-white/20 border border-white/20 hover:border-white/40 rounded-2xl p-4 transition-all duration-300 transform hover:scale-105 shadow-xl"
        >
          <div class="text-2xl mb-2 group-hover:scale-110 transition-transform duration-300">üèôÔ∏è</div>
          <div class="text-sm font-medium text-white">City</div>
        </a>
        <a
          href="#featured-properties"
          class="scroll-link group bg-white/10 backdrop-blur-md hover:bg-white/20 border border-white/20 hover:border-white/40 rounded-2xl p-4 transition-all duration-300 transform hover:scale-105 shadow-xl"
        >
          <div class="text-2xl mb-2 group-hover:scale-110 transition-transform duration-300">üöó</div>
          <div class="text-sm font-medium text-white">Luxury</div>
        </a>
        <a
          href="#featured-properties"
          class="scroll-link group bg-white/10 backdrop-blur-md hover:bg-white/20 border border-white/20 hover:border-white/40 rounded-2xl p-4 transition-all duration-300 transform hover:scale-105 shadow-xl"
        >
          <div class="text-2xl mb-2 group-hover:scale-110 transition-transform duration-300">‚ú®</div>
          <div class="text-sm font-medium text-white">Tours</div>
        </a>
      </div>

      <!-- Stats Compactas con efecto cristal -->
      <div class="bg-white/10 backdrop-blur-lg border border-white/20 rounded-2xl p-6 max-w-md mx-auto shadow-2xl">
        <div class="flex justify-center gap-8 text-white/90">
          <div class="text-center">
            <div class="text-2xl font-bold text-white">{rentals.length}+</div>
            <div class="text-sm">Properties</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-white">{cars.length}+</div>
            <div class="text-sm">Vehicles</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-white">{experiences.length}+</div>
            <div class="text-sm">Experiences</div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Scroll Indicator -->
  <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
    <div class="w-6 h-10 border-2 border-white/50 rounded-full flex justify-center bg-white/10 backdrop-blur-sm">
      <div class="w-1 h-3 bg-white/80 rounded-full mt-2 animate-pulse"></div>
    </div>
  </div>
</section>

<style>
  /* Smooth scroll */
  html {
    scroll-behavior: smooth;
  }

  /* Imagen con protagonismo */
  section img {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }

  /* Efecto cristal mejorado */
  .backdrop-blur-lg {
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
  }

  .backdrop-blur-md {
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }

  .backdrop-blur-sm {
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }

  /* Mobile optimizations */
  @media (max-width: 768px) {
    section {
      min-height: 100vh;
      min-height: 100svh;
    }
    
    section img {
      object-position: center;
    }

    /* Ajustar blur en m√≥vil para mejor rendimiento */
    .backdrop-blur-lg {
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
  }

  /* Hover effects m√°s suaves */
  @media (hover: hover) {
    .scroll-link:hover {
      transform: translateY(-2px) scale(1.05);
    }
  }

  /* Respeto a las preferencias de movimiento */
  @media (prefers-reduced-motion: reduce) {
    .animate-bounce {
      animation: none;
    }
    
    .animate-pulse {
      animation: none;
    }
    
    * {
      transition-duration: 0.01ms !important;
    }
  }

  /* Glassmorphism extra touches */
  .scroll-link {
    box-shadow: 
      0 8px 32px 0 rgba(31, 38, 135, 0.37),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
  }

  .scroll-link:hover {
    box-shadow: 
      0 8px 32px 0 rgba(31, 38, 135, 0.5),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Smooth scroll para todos los enlaces con scroll-link
    document.querySelectorAll(".scroll-link").forEach((link) => {
      link.addEventListener("click", (e) => {
        const href = link.getAttribute("href");
        
        // Si es una p√°gina externa, dejar el comportamiento normal
        if (href && !href.startsWith("#")) {
          return; // Permitir navegaci√≥n normal
        }
        
        // Si es un anchor link, hacer scroll
        if (href && href.startsWith("#")) {
          e.preventDefault();
          
          // Buscar el elemento objetivo
          let target = document.querySelector(href);
          
          // Si no existe el ID exacto, buscar por aria-labelledby
          if (!target) {
            const sectionWithLabel = document.querySelector(`[aria-labelledby="${href.slice(1)}"]`);
            if (sectionWithLabel) {
              target = sectionWithLabel;
            }
          }
          
          // Si a√∫n no existe, buscar la primera secci√≥n despu√©s del hero
          if (!target) {
            target = document.querySelector('main section:first-child');
          }
          
          if (target) {
            target.scrollIntoView({ 
              behavior: "smooth",
              block: "start" 
            });
          }
        }
      });
    });
  });
</script>
