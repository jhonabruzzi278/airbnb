---
import { getCollection } from "astro:content";

// Obtener datos para stats
const rentals = await getCollection("rentals");
let cars = [];
try {
  cars = await getCollection("cars");
} catch (error) {
  console.log("Cars collection not found");
}
---

<section class="relative min-h-[85vh] flex flex-col justify-center overflow-hidden">
  <!-- Background Image optimizado -->
  <div class="absolute inset-0">
    <img 
      src="/home-bg.jpg" 
      alt="Beautiful vacation rental home" 
      class="w-full h-full object-cover object-center"
      loading="eager"
      fetchpriority="high"
    />
    <!-- Overlay m√°s suave -->
    <div class="absolute inset-0 bg-gradient-to-b from-black/50 via-black/40 to-black/70"></div>
  </div>
  
  <!-- Hero Content - M√°s compacto -->
  <div class="relative z-10 text-center text-white px-4 py-6 max-w-5xl mx-auto">
    <!-- Main Title - Tama√±os reducidos -->
    <h1 class="text-2xl md:text-3xl lg:text-5xl font-bold mb-3 leading-tight drop-shadow-lg">
      Find Your Perfect
      <span class="text-transparent bg-clip-text bg-gradient-to-r from-pink-400 to-purple-400">
        Stay & Ride
      </span>
    </h1>
    
    <p class="text-sm md:text-base lg:text-lg mb-6 max-w-xl mx-auto opacity-90 drop-shadow-md leading-relaxed">
      Discover amazing properties and premium vehicles for your next adventure. 
      From cozy homes to luxury cars - we have it all.
    </p>

    <!-- Service Cards - M√°s compactas -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-4 mb-6 max-w-3xl mx-auto">
      <!-- Properties Card -->
      <div class="group bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20 hover:bg-white/20 transition-all duration-300 transform hover:-translate-y-1">
        <!-- Icono optimizado para mobile -->
        <div class="w-10 h-10 md:w-12 md:h-12 bg-pink-500/90 rounded-xl flex items-center justify-center mb-3 mx-auto group-hover:scale-110 transition-transform duration-300">
          <svg class="w-5 h-5 md:w-6 md:h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"/>
          </svg>
        </div>

        <h3 class="text-lg md:text-xl font-bold text-white mb-2 group-hover:text-pink-300 transition-colors duration-300">
          Properties & Stays
        </h3>
        
        <p class="text-white/80 text-xs md:text-sm leading-relaxed mb-3">
          Discover amazing homes, apartments, and unique stays for your perfect vacation.
        </p>

        <div class="flex items-center justify-center gap-2 mb-3">
          <div class="w-1.5 h-1.5 bg-pink-400 rounded-full"></div>
          <span class="text-xs font-medium text-white/70">{rentals.length}+ available properties</span>
        </div>

        <a 
          href="/listing"
          class="inline-flex items-center gap-2 bg-pink-500 hover:bg-pink-600 text-white px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-lg group/btn w-full justify-center text-xs md:text-sm"
        >
          <span>Browse Properties</span>
          <svg class="w-3 h-3 transform group-hover/btn:translate-x-1 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>

      <!-- Cars Card -->
      <div class="group bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20 hover:bg-white/20 transition-all duration-300 transform hover:-translate-y-1">
        <!-- Icono de coche optimizado -->
        <div class="w-10 h-10 md:w-12 md:h-12 bg-blue-500/90 rounded-xl flex items-center justify-center mb-3 mx-auto group-hover:scale-110 transition-transform duration-300">
          <svg class="w-5 h-5 md:w-6 md:h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 7h-3V6a3 3 0 00-3-3H7a3 3 0 00-3 3v1H1v6a2 2 0 002 2v4a1 1 0 001 1h2a1 1 0 001-1v-4h8v4a1 1 0 001 1h2a1 1 0 001-1v-4a2 2 0 002-2V7zM9 14a2 2 0 11-4 0 2 2 0 014 0zM19 14a2 2 0 11-4 0 2 2 0 014 0z"/>
          </svg>
        </div>

        <h3 class="text-lg md:text-xl font-bold text-white mb-2 group-hover:text-blue-300 transition-colors duration-300">
          Vehicle Rentals
        </h3>
        
        <p class="text-white/80 text-xs md:text-sm leading-relaxed mb-3">
          Find the perfect car for your trip. From economy to luxury and electric vehicles.
        </p>

        <div class="flex items-center justify-center gap-2 mb-3">
          <div class="w-1.5 h-1.5 bg-blue-400 rounded-full"></div>
          <span class="text-xs font-medium text-white/70">{cars.length}+ vehicles available</span>
        </div>

        <a 
          href="/cars"
          class="inline-flex items-center gap-2 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-lg group/btn w-full justify-center text-xs md:text-sm"
        >
          <span>Rent a Vehicle</span>
          <svg class="w-3 h-3 transform group-hover/btn:translate-x-1 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>
    </div>

    <!-- Quick Categories - M√°s compactas -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-2 max-w-2xl mx-auto mb-6">
      <a href="/categories/beach" class="group p-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 hover:bg-white/20 transition-all duration-300">
        <div class="text-lg md:text-xl mb-1 group-hover:scale-110 transition-transform duration-300">üèñÔ∏è</div>
        <div class="text-xs font-medium text-white/90 group-hover:text-white">Beach Houses</div>
      </a>
      
      <a href="/categories/city" class="group p-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 hover:bg-white/20 transition-all duration-300">
        <div class="text-lg md:text-xl mb-1 group-hover:scale-110 transition-transform duration-300">üèôÔ∏è</div>
        <div class="text-xs font-medium text-white/90 group-hover:text-white">City Apartments</div>
      </a>
      
      <a href="/cars/category/economy" class="group p-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 hover:bg-white/20 transition-all duration-300">
        <div class="text-lg md:text-xl mb-1 group-hover:scale-110 transition-transform duration-300">üöó</div>
        <div class="text-xs font-medium text-white/90 group-hover:text-white">Economy Cars</div>
      </a>
      
      <a href="/cars/category/electric" class="group p-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 hover:bg-white/20 transition-all duration-300">
        <div class="text-lg md:text-xl mb-1 group-hover:scale-110 transition-transform duration-300">‚ö°</div>
        <div class="text-xs font-medium text-white/90 group-hover:text-white">Electric Cars</div>
      </a>
    </div>

    <!-- Stats - M√°s compactas -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 max-w-2xl mx-auto">
      <div class="text-center">
        <div class="text-xl md:text-2xl font-bold text-white mb-1">{rentals.length}+</div>
        <div class="text-white/80 text-xs">Properties</div>
      </div>
      <div class="text-center">
        <div class="text-xl md:text-2xl font-bold text-white mb-1">{cars.length}+</div>
        <div class="text-white/80 text-xs">Vehicles</div>
      </div>
      <div class="text-center">
        <div class="text-xl md:text-2xl font-bold text-white mb-1">1000+</div>
        <div class="text-white/80 text-xs">Happy Clients</div>
      </div>
      <div class="text-center">
        <div class="text-xl md:text-2xl font-bold text-white mb-1">24/7</div>
        <div class="text-white/80 text-xs">Support</div>
      </div>
    </div>
  </div>

  <!-- Scroll indicator -->
  <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 animate-bounce z-10">
    <svg class="w-4 h-4 text-white/80 drop-shadow-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
    </svg>
  </div>
</section>

<style>
  /* Asegurar que la imagen se cargue correctamente */
  section img {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }
  
  /* Optimizaci√≥n para m√≥viles */
  @media (max-width: 768px) {
    section {
      min-height: 85vh;
      min-height: 85svh; /* Para m√≥viles modernos */
    }
  }
</style>

<script>
  // Mejorar la carga de imagen
  document.addEventListener('DOMContentLoaded', function() {
    const img = document.querySelector('section img') as HTMLImageElement;
    if (img) {
      // Precargar la imagen
      const preloadImg = new Image();
      preloadImg.src = '/home-bg.jpg';
      
      preloadImg.onload = function() {
        console.log('‚úÖ Imagen precargada correctamente');
        img.style.opacity = '1';
      };
      
      preloadImg.onerror = function() {
        console.log('‚ùå Error cargando imagen /home-bg.jpg');
        // Fallback con gradiente
        const fallback = document.createElement('div');
        fallback.className = 'absolute inset-0 bg-gradient-to-br from-pink-500 via-purple-600 to-indigo-700';
        if (img.parentElement) {
          img.parentElement.appendChild(fallback);
        }
        img.style.display = 'none';
      };
    }
  });
</script>